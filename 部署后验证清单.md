# 部署后验证清单

## ✅ 部署状态检查

### 1. GitHub 推送确认
- [x] 代码已推送到 GitHub 仓库
- [x] 提交信息: `feat: 添加出差申请单审批功能`
- [x] 提交哈希: `52cd816`

### 2. Vercel 部署验证

**检查步骤**:
1. 访问 GitHub Actions: https://github.com/HMC1234/-yqf-aibtrip-demo/actions
   - 查看是否有 Vercel 的部署钩子触发
2. 访问 Vercel Dashboard: https://vercel.com/dashboard
   - 查看项目 `yqf-aibtrip-demo` 的最新部署
   - 确认部署状态为 "Ready" 或 "Building"
3. 访问部署地址: https://yqf-aibtrip-demo.vercel.app
   - 等待 2-5 分钟让部署完成
   - 刷新页面验证是否已更新

**验证功能**:
- [ ] 页面可以正常访问
- [ ] 登录功能正常
- [ ] 个人中心可以看到审批权限字段
- [ ] 出差申请列表可以看到审批按钮
- [ ] 审批功能可以正常使用

---

### 3. 腾讯云 COS 部署验证

**检查步骤**:
1. 访问 GitHub Actions: https://github.com/HMC1234/-yqf-aibtrip-demo/actions
   - 查看工作流 "Deploy to Tencent Cloud COS (New)" 的运行状态
   - 点击进入查看详细日志
   - 确认所有步骤都显示 ✅

2. 等待部署完成（通常 3-5 分钟）

3. 访问部署地址（使用您配置的自定义域名）
   - 验证页面是否已更新

**验证功能**:
- [ ] 页面可以正常访问
- [ ] 功能测试与 Vercel 相同

---

## 🗄️ 数据库迁移验证

**重要**: 部署后必须在 Supabase 中执行数据库迁移脚本！

### 执行步骤:

1. 访问 Supabase Dashboard
2. 进入 SQL Editor
3. 执行以下脚本:

```sql
-- 添加 can_approve 字段
ALTER TABLE users ADD COLUMN IF NOT EXISTS can_approve BOOLEAN DEFAULT true;

-- 设置默认值
UPDATE users SET can_approve = true WHERE can_approve IS NULL;

-- 设置 test@example.com 用户权限
UPDATE users SET can_approve = true WHERE email = 'test@example.com';

-- 验证
SELECT email, can_approve FROM users WHERE email = 'test@example.com';
```

4. 等待 10-30 秒让 schema cache 刷新
5. 刷新浏览器页面并重新测试

---

## 🧪 功能测试清单

### 测试 1: 个人中心审批权限设置
- [ ] 登录 `test@example.com`
- [ ] 进入个人中心 → 个人信息
- [ ] 能看到"审批权限"字段（带开关）
- [ ] 开关可以正常切换
- [ ] 切换后权限正确保存

### 测试 2: 列表页面审批功能
- [ ] 进入"出差申请" → "我的出差申请"
- [ ] 在"待审批"标签页中，能看到"审批"按钮
- [ ] 点击"审批"按钮，显示确认对话框
- [ ] 确认审批后，申请单状态更新为"已审批"
- [ ] 审批按钮消失

### 测试 3: 详情页面审批功能
- [ ] 打开一个"待审批"状态的申请单详情
- [ ] 能看到"审批"按钮（在状态标签旁边）
- [ ] 点击"审批"按钮，显示确认对话框
- [ ] 确认审批后，申请单状态更新为"已审批"
- [ ] 审批按钮消失
- [ ] 显示"经典预订"和"AI智能预订"按钮

---

## 📊 部署状态监控

### Vercel 部署
- **Dashboard**: https://vercel.com/dashboard
- **部署地址**: https://yqf-aibtrip-demo.vercel.app
- **预计完成时间**: 2-5 分钟

### 腾讯云 COS 部署
- **Actions 页面**: https://github.com/HMC1234/-yqf-aibtrip-demo/actions
- **工作流名称**: "Deploy to Tencent Cloud COS (New)"
- **预计完成时间**: 3-5 分钟

---

## ✅ 最终确认

所有平台部署完成后，请确认：

1. ✅ Vercel 部署成功，网站可以访问
2. ✅ 腾讯云 COS 部署成功（如果使用）
3. ✅ 数据库迁移脚本已执行
4. ✅ 所有功能测试通过

**部署完成！** 🎉


