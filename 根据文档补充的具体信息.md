# 根据文档补充的具体信息

## 📋 文档分析

根据 `广州中航服机票文档_v12.md`，我补充了以下具体信息：

## ✅ 已补充的内容

### 1. 航班查询接口参数完善

根据文档第141-171行，补充了以下参数：

- ✅ **ChildQty**（儿童数量）：已添加到查询表单
- ✅ **IsQueryAirline**（查询航空公司）：已添加选项
- ✅ **CodeShare**（查询代码共享）：已添加选项
- ✅ **IsQueryAirport**（查询机场）：已添加选项

### 2. 创建订单接口注意事项

根据文档第514-549行，补充了以下重要提示：

- ✅ **证件信息要求**：
  - 使用身份证时，Birthday可从证件号自动解析
  - 使用护照等非身份证时，必须提供Birthday和CertValid
  - 已在测试页面添加提示信息

- ✅ **FQKey获取说明**：
  - 机票的FQKey需要先调用机票验价接口获取
  - 已在测试页面添加说明

- ✅ **响应处理注意事项**：
  - Code=0表示成功，其他值表示失败
  - 机票订单需检查PNR是否为空，为空表示订座失败
  - 火车票订单需检查PONr是否为空，为空表示下单失败

### 3. 新增其他接口测试

根据文档，添加了以下接口的测试功能：

#### ✅ 订单列表查询（第564-576行）
- 接口：`BizApi.OpenAPI.GetOrderList`
- 参数：StartDate、EndDate、OrderStatusID、PageIndex、PageSize
- 已添加到"其他接口"标签页

#### ✅ 验舱并补位（第559-562行）
- 接口：`BizApi.OpenAPI.Shopping.VerifyCabin`
- 参数：FQKey
- 已添加到"其他接口"标签页

#### ✅ 查询退票费（第606-609行）
- 接口：`BizApi.AirTickets.Shopping.AirRefundPriceServing`
- 参数：FQKey
- 已添加到"其他接口"标签页

#### ✅ 获取退改条款（第611-614行）
- 接口：`BizApi.AirTickets.Shopping.GetFareRuleDetailServing`
- 参数：FQKey
- 已添加到"其他接口"标签页

#### ✅ 获取机场列表（第616-625行）
- 接口：`BizApi.OpenAPI.Dest.GetAirportList`
- 参数：CountryCode（可选）
- 说明：根据国家编码获取机场列表
- 已添加到"其他接口"标签页

### 4. 响应数据结构

根据文档，响应数据包含以下结构：

#### 航班查询响应（第173-191行）
- JourneyBiz
- BriefRuleResult
- JourneySegmentResult
- JourneyTicketResult
- TicketAgencyResult
- TicketPricingResult
- TicketFareResult
- TicketFareFlightResult
- JourneyBrandResult

#### 验价响应（第209-227行）
- VerifySegment
- VerifyLeg
- VerifyPricing
- VerifyTicket
- VerifyTicketLeg
- VerifyFare
- VerifyTax
- VerifyBaggage
- VerifySplitPrice

#### 创建订单响应（第477-512行）
- 成功响应包含：Code、Msg、TradeNo、Orders
- 失败响应包含：Code、Msg、TradeNo（null）、Orders（空数组）

### 5. 产品类型说明

根据文档第240-242行，ProductCategoryID产品大类枚举：
- 8：国内机票
- 9：国际机票
- 2：酒店
- 3：火车票
- 4：保险
- 5：签证
- 10：欧铁点到点
- 11：欧铁通票

### 6. 完整业务流程

根据文档第88-137行，业务流程包括：

#### 国际机票查询、预订、确认出票流程
1. 调用查询接口
2. 调用验价接口
3. 填写资料
4. 调用创建订单接口
5. 支付前需要再核验一次座位是否可用
6. 调用提交订单接口
7. 支付成功

#### 国际机票改期流程
1. 选择需要变更的票号
2. 选择需变更航段
3. 选择新航段
4. 调用改期接口
5. 接收改期票号推送

#### 退票流程
1. 选择需退票票号
2. 选择自愿/非自愿
3. 调用退票接口
4. 接收退票状态和费用推送

## 📝 测试页面更新

### 新增功能

1. **"其他接口"标签页**：
   - 订单列表查询
   - 验舱并补位
   - 查询退票费
   - 获取退改条款
   - 获取机场列表

2. **航班查询参数完善**：
   - 儿童数量（ChildQty）
   - 查询航空公司（IsQueryAirline）
   - 查询代码共享（CodeShare）
   - 查询机场（IsQueryAirport）

3. **创建订单提示信息**：
   - 证件信息要求说明
   - FQKey获取说明
   - 护照必填字段提示

## ⚠️ 注意事项

### 1. API调用地址
文档中第10-11行提到"所有API接口统一通过以下地址调用"，但具体地址未显示。需要从供应商获取完整的Base URL。

### 2. 系统级参数
根据文档第18-19行，系统级参数通过URL查询字符串传递，包括：
- app_key
- method（接口方法名）
- version（可选）

### 3. 加密要求
根据文档第24-27行：
- 加密算法：AES/CBC/PKCS5Padding
- IV：16字节空字节数组
- 密钥长度：16或32字节
- 字符编码：UTF-8

### 4. HTTP请求头
根据文档第38-40行：
- Content-Type: text/plain
- Accept-Encoding: gzip, deflate

### 5. 响应格式
根据文档第64-83行：
- 成功：Code=0，包含Data字段
- 失败：Code≠0，包含错误信息

## 🔧 代码实现

所有补充的功能已实现：

- ✅ 测试页面新增"其他接口"标签页
- ✅ 航班查询参数完善
- ✅ 创建订单提示信息
- ✅ 所有接口的测试功能
- ✅ 响应数据显示

## 📚 相关文件

- 测试页面：`src/pages/Test/YQFAPITest.tsx`
- API接口：`src/lib/yqf-air/flight-api.ts`
- 类型定义：`src/lib/yqf-air/types.ts`
- 使用说明：`中航服API测试页面使用说明.md`

---

**总结**：根据文档补充了所有可用的接口测试功能，完善了参数输入，并添加了重要的提示信息。测试页面现在可以测试文档中提到的所有主要接口。

