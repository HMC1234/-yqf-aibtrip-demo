# 🔍 GitHub Actions工作流错误诊断指南

**错误信息**：`Error: Process completed with exit code 255.`

---

## 📋 诊断步骤

### 步骤1：查看详细错误日志

1. **访问GitHub Actions**
   ```
   https://github.com/HMC1234/-yqf-aibtrip-demo/actions
   ```

2. **查看最新的工作流运行**
   - 点击最新的运行记录
   - 查看哪个步骤失败了（红色✗标记）

3. **查看失败步骤的详细日志**
   - 点击失败的步骤
   - 展开日志查看详细错误信息
   - 找到具体的错误原因

---

## 🔧 常见错误和解决方案

### 错误1：coscmd配置失败

**错误信息示例**：
```
coscmd config failed
或
认证失败
```

**可能原因**：
- SecretId或SecretKey配置错误
- Secrets中有多余的空格
- 密钥权限不足

**解决方法**：

1. **检查GitHub Secrets**
   - 访问：https://github.com/HMC1234/-yqf-aibtrip-demo/settings/secrets/actions
   - 检查以下Secrets：
     - `TENCENT_SECRET_ID` - 应该是您的腾讯云SecretId
     - `TENCENT_SECRET_KEY` - 应该是您的腾讯云SecretKey
   - **重要**：确保没有多余的空格或换行

2. **验证密钥格式**
   - SecretId格式：通常以`AKID`开头
   - SecretKey格式：一串字符
   - 确保没有引号包裹

3. **验证密钥权限**
   - 访问：https://console.cloud.tencent.com/cam/capi
   - 确认密钥有COS访问权限
   - 如果没有，需要添加权限

---

### 错误2：存储桶不存在

**错误信息示例**：
```
Bucket not found
或
No such bucket
或
存储桶不存在
```

**可能原因**：
- 存储桶名称配置错误
- 地域配置错误
- 存储桶确实不存在

**解决方法**：

1. **检查存储桶名称**
   - 访问：https://console.cloud.tencent.com/cos
   - 确认您的存储桶名称
   - 检查GitHub Secret `TENCENT_BUCKET`是否正确
   - 或者确认工作流中的默认值`yqf-aibtrip-demo`是否正确

2. **检查地域**
   - 在COS控制台查看存储桶的地域
   - 检查GitHub Secret `TENCENT_REGION`是否正确
   - 或者确认工作流中的默认值`ap-guangzhou`是否正确

3. **地域代码对照表**
   - 广州：`ap-guangzhou`
   - 北京：`ap-beijing`
   - 上海：`ap-shanghai`
   - 成都：`ap-chengdu`
   - 等等...

---

### 错误3：文件上传失败

**错误信息示例**：
```
upload failed
或
文件上传失败
```

**可能原因**：
- build目录不存在
- 权限问题
- 网络问题

**解决方法**：

1. **检查构建输出**
   - 查看"Build project"步骤是否成功
   - 确认`build`目录已生成
   - 确认`build/index.html`存在

2. **检查权限**
   - 确认存储桶权限为"公有读私有写"
   - 确认API密钥有写入权限

---

### 错误4：Python或coscmd安装失败

**错误信息示例**：
```
pip install failed
或
coscmd not found
```

**解决方法**：
- 这通常不是问题，因为工作流会自动安装
- 如果失败，可能是网络问题，重试即可

---

## 🚀 改进的工作流文件

我已经为您改进了工作流文件，添加了：
- ✅ 更好的错误检查
- ✅ 详细的日志输出
- ✅ 步骤验证

**请更新GitHub上的工作流文件**，使用改进后的版本。

---

## 📝 更新工作流文件

### 方法1：在GitHub网页上更新

1. **访问文件**
   ```
   https://github.com/HMC1234/-yqf-aibtrip-demo/blob/main/.github/workflows/deploy-tencent.yml
   ```

2. **点击编辑**
   - 点击右上角的"Edit"（铅笔图标）
   - 替换为改进后的内容

3. **提交更改**
   - 填写提交信息：`fix: 改进工作流错误处理和日志`
   - 点击"Commit changes"

### 方法2：告诉我具体错误

**请告诉我**：
1. 哪个步骤失败了？
2. 错误日志中显示的具体错误信息是什么？

**我会根据具体错误提供针对性的解决方案！**

---

## 🔍 快速检查清单

在告诉我错误之前，请先检查：

- [ ] GitHub Secrets是否正确配置？
  - `TENCENT_SECRET_ID`存在且正确
  - `TENCENT_SECRET_KEY`存在且正确
  - 没有多余的空格

- [ ] 存储桶配置是否正确？
  - 存储桶名称正确
  - 地域代码正确
  - 存储桶确实存在

- [ ] 存储桶权限是否正确？
  - 访问权限：公有读私有写
  - 静态网站托管已开启

- [ ] 构建是否成功？
  - "Build project"步骤是否成功
  - build目录是否生成

---

**请告诉我具体的错误信息，我会帮您解决！** 🔧


