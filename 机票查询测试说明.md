# 机票查询接口测试说明

## 测试参数

根据您的要求：
- **出发地**：广州
- **目的地**：北京
- **出发日期**：2025年12月1日

## 测试方式

### 方式1：使用测试页面（推荐）

1. **打开测试页面**
   - 访问：`http://localhost:3000/test/yqf-api`

2. **配置API信息**
   - 切换到"配置"标签页
   - 填写以下信息：
     - **API Base URL**：`https://bizapi.yiqifei.cn/servings`（默认值）
     - **App Key**：您的应用密钥
     - **App Secret**：您的应用密钥
     - **API Version**：`2.0`（默认值）
     - **注册公司（OfficeIds）**：`EI00D`（默认值，请根据实际情况修改）
   - 点击"保存配置"

3. **测试航班查询**
   - 切换到"航班查询"标签页
   - 填写查询参数：
     - **出发地**：选择"广州"
     - **目的地**：选择"北京"
     - **出发日期**：选择"2025-12-01"
     - **乘客类型**：成人（ADT）
     - **航班类型**：国内（D）
     - **舱位类型**：经济舱（Y）
     - **注册公司（OfficeIds）**：`EI00D`（或您的实际注册公司代码）
   - 点击"查询航班"按钮

4. **查看结果**
   - 在页面下方查看响应数据
   - 如果成功，会显示航班信息
   - 如果失败，会显示错误信息

### 方式2：使用Node.js测试脚本

1. **设置环境变量**（在PowerShell中）：
   ```powershell
   $env:REACT_APP_YQF_APP_KEY="your_app_key"
   $env:REACT_APP_YQF_APP_SECRET="your_app_secret"
   ```

2. **运行测试脚本**：
   ```bash
   node test-flight-search.js
   ```

## 请求参数详情

根据您的要求，实际发送的请求参数如下：

```json
{
  "Passengers": [
    { "PassengerType": "ADT" }
  ],
  "Routings": [
    {
      "Departure": "CAN",  // 广州
      "Arrival": "PEK",   // 北京
      "DepartureDate": "2025-12-01",
      "DepartureType": 1,
      "ArrivalType": 1
    }
  ],
  "OfficeIds": ["EI00D"],  // 注册公司（必填）
  "Type": "D",             // 国内
  "OnlyDirectFlight": false,
  "BerthType": "Y",        // 经济舱
  "ChildQty": 0,
  "IsQueryRule": false,
  "IsQueryAirline": false,
  "CodeShare": false,
  "IsQueryAirport": false
}
```

## 系统级参数（URL查询字符串）

```
https://bizapi.yiqifei.cn/servings?version=2.0&app_key=your_app_key&method=ShoppingServer.EasyShopping_V2
```

## 预期响应

### 成功响应

```json
{
  "Code": 0,
  "Msg": "调用成功",
  "Data": {
    "JourneyBiz": [...],      // 行程信息
    "Segment": [...],          // 航段信息
    "Fare": [...],            // 票价信息
    "JourneySegmentResult": [...],
    "JourneyTicketResult": [...],
    ...
  }
}
```

### 错误响应

```json
{
  "Code": 1001,
  "Msg": "参数错误",
  "Data": null
}
```

## 注意事项

1. **OfficeIds（注册公司）**：这是必填参数，请使用您的实际注册公司代码
2. **App Secret**：必须是16或32字节，请确保没有多余的空格
3. **Version**：必须填写 `2.0`
4. **接口名称**：`ShoppingServer.EasyShopping_V2`（根据文档接口列表）

## 如果遇到问题

### CORS错误
- 如果直接调用遇到CORS错误，可以在配置中将 `API Base URL` 改为 `/api/yqf` 使用代理

### 404错误
- 检查API地址是否正确
- 检查代理配置是否正确（如果使用代理）

### 参数错误
- 检查 `OfficeIds` 是否正确
- 检查 `version` 是否为 `2.0`
- 检查 `app_key` 和 `app_secret` 是否正确

## 测试结果

测试完成后，请查看：
1. **浏览器控制台**：查看详细的请求和响应日志
2. **Network标签**：查看实际的HTTP请求和响应
3. **响应数据**：查看返回的航班信息


