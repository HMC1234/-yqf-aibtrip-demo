# 🔄 强制重启服务器指南

## ⚠️ 重要提示

如果你仍然看到404错误，**必须完全重启开发服务器**才能让代理配置生效。

## 🔍 检查代理是否已加载

### 方法1: 查看终端启动日志

重启服务器后，在终端中应该看到：
```
✅ setupProxy.js 已加载
✅ 代理配置已设置: /api/yqf -> https://bizapi.yiqifei.cn/servings
```

**如果没有看到这些日志，说明代理没有加载！**

### 方法2: 测试请求时查看日志

当有API请求时，终端应该显示：
```
🔵 [代理] 请求: POST /api/yqf?app_key=...
🔵 [代理] 目标路径: /servings?app_key=...
🟢 [代理] 响应: 200 /api/yqf?app_key=...
```

**如果没有看到这些日志，说明代理没有工作！**

## 🛠️ 强制重启步骤

### 步骤1: 完全停止服务器

1. **找到运行 `npm start` 的终端窗口**
2. **按 `Ctrl + C` 停止服务器**
3. **等待几秒钟，确保进程完全停止**

### 步骤2: 检查进程是否还在运行

打开新的PowerShell窗口，执行：
```powershell
netstat -ano | findstr :3000
```

**如果还有输出，说明进程还在运行，需要强制停止：**

```powershell
# 查找Node.js进程
Get-Process -Name node -ErrorAction SilentlyContinue | Stop-Process -Force
```

### 步骤3: 清除缓存（可选但推荐）

```powershell
# 清除npm缓存
npm cache clean --force

# 删除node_modules/.cache（如果存在）
Remove-Item -Recurse -Force node_modules\.cache -ErrorAction SilentlyContinue
```

### 步骤4: 重新启动服务器

```bash
npm start
```

### 步骤5: 验证代理已加载

**在终端启动日志中，应该看到：**
```
✅ setupProxy.js 已加载
✅ 代理配置已设置: /api/yqf -> https://bizapi.yiqifei.cn/servings
Compiled successfully!
```

**如果没有看到这些日志，说明有问题！**

## 🔍 如果代理仍然没有加载

### 检查1: 文件位置

确认 `src/setupProxy.js` 文件存在：
```powershell
dir src\setupProxy.js
```

### 检查2: 文件内容

确认文件内容正确（应该看到 `module.exports = function(app)`）

### 检查3: 语法错误

检查终端是否有语法错误信息

### 检查4: 依赖包

确认 `http-proxy-middleware` 已安装：
```bash
npm list http-proxy-middleware
```

## 🧪 测试代理

### 测试步骤

1. **重启服务器**（必须！）
2. **查看终端启动日志**（确认看到代理加载消息）
3. **打开测试页面**: http://localhost:3000/test/yqf-api
4. **填写配置并测试**
5. **查看终端日志**（确认看到代理请求日志）

### 预期结果

**终端应该显示：**
```
✅ setupProxy.js 已加载
✅ 代理配置已设置: /api/yqf -> https://bizapi.yiqifei.cn/servings
...
🔵 [代理] 请求: POST /api/yqf?app_key=...
🔵 [代理] 目标路径: /servings?app_key=...
🟢 [代理] 响应: 200 /api/yqf?app_key=...
```

**浏览器Network标签应该显示：**
- 请求URL: `http://localhost:3000/api/yqf?...`
- 状态码: 200（或其他HTTP状态码，不是404）

## ❌ 如果仍然404

请提供以下信息：

1. **终端启动日志**（特别是是否有代理加载消息）
2. **测试请求时的终端日志**（是否有代理请求日志）
3. **浏览器Network标签截图**（请求详情）
4. **确认是否真的重启了服务器**

---

**重要**: 99%的404错误都是因为服务器没有完全重启！

