广州中航服机票文档 v1.2​

1. 接口调用原理
调用一起飞的API接口，是客户端与服务端进行数据交互的过程。客户端（您的应用程序）通过发送HTTP请求，调用一起飞服务端提供的API接口，实现数据的查询和操作。​
2. 开始使用前的准备
在调用API之前，您需要先获取应用凭证：​
•app_key（应用密钥）：一起飞开放平台为每个应用分配的唯一标识ID。您可以在中创建		应用后获取。
•app_secret（应用密钥）：用于数据加密的密钥，请妥善保管，切勿泄露！该密钥将用于加密请求数据。

3. API 调用地址​
所有API接口统一通过以下地址调用：​
​
4. 参数说明
调用API时需要传递两类参数：​
•系统级参数：通过 URL 查询字符串传递，用于标识应用和接口​
•
应用级参数：通过 HTTP Body 传递，包含业务数据（需要加密）​5. 系统级参数详解
系统级参数通过 URL 查询字符串传递，用于指定接口版本、应用身份和调用方法。​示例：
			&​
6. 应用级参数详解
应用级参数是您的业务数据，需要经过以下步骤处理：1. 将业务参数组织成符合 JSON 规范的格式​
2. 使用 app_secret 作为密钥，对 JSON 字符串进行 AES 加密​3. 对加密后的字节数据进行 Base64 编码​
4. 将编码后的字符串作为 HTTP Body 发送​
加密算法：AES/CBC/PKCS5Padding
初始化向量（IV）：长度为 16 的空字节数组（即：
\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0 ）
加密密钥：使用您的 app_secret （长度必须为 16 或 32 字节）​字符编码：UTF-8​

测试示例：
测试密钥：1234567890123456
原始文本：

加密后的 Base64 结果：​

提示：如果您的加密结果与上述结果一致，说明加密实现正确。

5. 发送 HTTP 请求​
将加密后的应用级参数作为 HTTP Body，通过 POST 方式发送到完整的 API 地址。​		⚠️ 重要：HTTP 请求头设置​
		请求时必须设置以下 HTTP Header：​
		Content-Type: text/plain​
完整调用示例：
		步骤 1：准备参数​
步骤 2：准备业务参数（JSON 格式）​
{​

"To": "",​

}​
	步骤 3：加密并编码​
	使用 app_secret（08212a1694c64992 ）作为密钥，对上述 JSON 进行 AES 加密，再进行 Base64 编码，得到：​

vDUMMYIpg+c1Idzbnwt0JLOXc7jhkLSlH/Bd8k2TqQSMIzbHLOJwtU05T8sjobCHNL21lzWp X7FaELY8dcfhxpb5/fzrnXYIXSYfJUEzqG25TcDCI8W1xhhc7Dl0UGCaWkLA/+7c0J/Cwb+GGUSnE MPGl8BnyTmptS78EmmpITA=​
	步骤 4：发送 HTTP POST 请求​
	请求 URL：​

​	请求 Header：​

Accept-Encoding: gzip, deflate​
请求 Body：​

vDUMMYIpg+c1Idzbnwt0JLOXc7jhkLSlH/Bd8k2TqQSMIzbHLOJwtU05T8sjobCHNL21lzWp 	X7FaELY8dcfhxpb5/fzrnXYIXSYfJUEzqG25TcDCI8W1xhhc7Dl0UGCaWkLA/+7c0J/Cwb+GGUSnE 	MPGl8BnyTmptS78EmmpITA=​
6. 响应结果

API 调用后会返回 JSON 格式的响应数据，包含以下字段：​

✅ 成功响应示例：​

{​
 "Code": 0,​
 "Msg": "调用成功",​
 "Data": {​
	 // 返回的业务数据​
	 ...​

}​

}​

❌ 错误响应示例：​

{​

}​

7. 重要注意事项
Encoding: gzip, deflate  启用压缩，减少传输数据量​

1. 接口列表​
2. 业务流程图​
国际机票查询，预订、确认出票流程

调用

调用

调用

填写资料

消，支付前需要再核验
一次座位是否可用。

调用
支付成功
	BizApi.OpenAPI.SubmitOrder

国际机票改期流程

选择需要变更的票号

选择需变更航段

选择新航段

改期新票号

对接方提交接口接收改期票号推送

退票流程

选择需退票票号

自愿/非自愿

退票

自愿

BizApi.OpenAPI.SubmitOrder确认退票

BizApi.HBTrips.Order.GetOrderList

回调退票状态

和费用

对接方提交接口接收退票状态推送

3. 接口说明​
1. BizApi.OpenAPI.Shopping.EasyShopping_V2​
请求参数

"Passengers": [​
 {​
		 "PassengerType": "ADT"​
 }​
 ],​
 "OnlyDirectFlight": false,
 "BerthType": "Y",​
 "IsQueryRule": false,​
 "IsQueryAirline": false,​
 "CodeShare": false,​
 "IsQueryAirport": false,​
 "Routings": [​
 {​
		 "Departure": "CAN",​
		 "Arrival": "SIN",​
		 "ArrivalType": 1,​
		 "DepartureDate": "2023-03-27",​
		 "DepartureType": 1​
 },​
 {​
		 "Departure": "SIN",​
		 "Arrival": "CAN",​
		 "ArrivalType": 1,​
		 "DepartureDate": "2023-03-30",​
		 "DepartureType": 1​
 }​
 ],​
 "Type": "A",​
 "ChildQty": 0,​

响应参数

JourneyBiz​

BriefRuleResult​

JourneySegmentResult​

JourneyTicketResult​

TicketAgencyResult​

TicketPricingResult​

TicketFareResult​

TicketFareFlightResult​

JourneyBrandResult​

2. BizApi.AirTickets.Shopping.VerifyPriceServing  验价​
应用场景：预订前验价和验舱

请求参数

VerifyPassenger​

VerifySegmentRequest​

VerifyLegRequest​

23T00:00:00|key(RuleTariff::Rule::OWRT::Routing::Footnote1::Footnote2::Passenge rType::FareType::OriginAddonTariff::OriginAddonFootnote1::OriginAddonFootnote2: :DestinationAddonTariff::DestinationAddonFootnote1::DestinationAddonFootnote2:: TravelAgencyCode::IataNumber::DepartmentCode::Origin::Destination::FareSource:: FbrBaseTariff::FbrBaseRule::AccountCode::FbrBaseFareBasis::OriginAddonRouting:: DestinationAddonRouting::R3c025TblNo)|008::CSL1::1::0202::::::ADT::PRU::008::::

4	 "FQKey": 
"H4sIAAAAAAAAA52RX3OiMBTFv0te124TURBm9gFiVRBQhz+d3Z19QAgWi9AGkGD1uzdB68M+luGBe3 POuT9yP8CaZjGpgPb3A6yjqiLFjlC/eyNAA/rUBwOAG0pJEXe8gd3fvOGVDY2JEVWk9wJtqED4Ew6AH zGgyaoivvsjg5LoNSnbAmhFk+eXf1xzi+Y5s4iKlKya5dnupb4y3Jtc5C6f4LNh21yrZzTPCuF0AmHt HW5z2BLKe2NlBHl3St4iWjdUyLDuChul2THKeb105qI2RL6ZCIIzl5w90z07wflr0nkIh9IDRA9DyYd Q619wGXwTS5UR+g/rhnHH4vO/jcVv0+KrKEiHy0SED2NJjuVUGm0hQiRRI1lJUaqOJzLZKtJ4yyet86 jOih2OOEHP2HPru9uC0ZPQYHy9QCQJfCPb4aaqywOh1zlilQOwSlNCzem9rF94WaQlty5Glal/PYrLv I4t1ZjZHYpNfMRt6FtBRR3Lw23jV8j2O7h895g59Zh7wkfLXuZB7IzX3jYM42JjBaG9qUVOxlYGEWcn 155AWoVB5+zjNphZrZ3Bd49n0XJTJsfINnC16jzVOum5RU2dutSBTA6e/+D9ZuKw7HWhs3n9uDqpx9B

响应结果

VerifySegment​

VerifyLeg​

VerifyPricing​

VerifyTicket​

VerifyTicketLeg​

VerifyFare​

VerifyTax​

VerifyBaggage​

VerifySplitPrice​

3. BizApi.OpenAPI.Easy.AICreateOrder​
接口说明: AI智能创建订单接口，支持机票、酒店、火车票、保险、签证、欧铁等多种产品类型的订单

创建

接口类型: POST​

请求参数

主要参数

产品类型说明

ProductCategoryID 产品大类枚举：​

请求对象定义

接口定义了 20 个请求对象。

AIProduct​

AIPassenger​

EContactInfo​
说明: 联系人信息​

AIAirTicket​
说明: 机票产品，ProductCategoryID=8/9时，此处必填​

AIHotel​
说明: 酒店产品，ProductCategoryID=2时，此处必填​

AITrain​
说明: 火车票产品，ProductCategoryID=3 时，此处必填​

AIInsurance​
说明: 保险产品，ProductCategoryID=4时，此处必填（国内机票按航班下单，国际机票下一个即可）​

AIVisa​

说明: 签证产品，ProductCategoryID=5 时，此处必填​

AIBizPolicy​

说明: 差旅政策和成本中心​

AICostCenter​

AIShip​

说明: 船票产品，ProductCategoryID=3,SubProductCategoryID=717 时，此处必填​

AIEurailPASS​

说明: 欧铁通票产品，ProductCategoryID=11 时，此处必填​

AIEurailPTP​

说明: 欧铁点到点产品，ProductCategoryID=10 时，此处必填​

DeliveryInfo​

说明: 配送信息，可选​

ExtraExpense​

说明: 额外费用​

其他对象

AIEurPTPLeg​

AIInsFlight​

AITrainLeg​

AITravelProduct​

AITravelProductCombo​

响应参数

响应主体

响应对象定义

AIPassengerRsp​

AIProductRsp​

使用示例

示例1：创建国内机票订单​

{​
 "SourceTypeID": 1,​
 "PaymentMethodID": 1,​
 "SettlementTypeID": 11,​
 "Products": [​
	 {​
			 "ProductCategoryID": 8,​
			 "GDSCode": "1E",​
			 "PublicAmount": 1200.00,​
			 "PrivateAmount": 0,​
			 "Air": {​
				 "FQKey": "xxxxx_verification_key",​
				 "TripType": 1​

}​
	 }​
 ],​
 "Passengers": [​
	 {​
			 "LastName": "张",​
			 "FirstName": "三",​
			 "PassengerTypeCode": "ADT",​
			 "Gender": "M",​
			 "CertTypeCode": "ID",​
			 "CertNr": "110101199001011234",​
			 "Mobile": "13800138000"​
	 }​
 ],​
 "ContactInfo": {​
	 "Name": "张三",​
	 "Mobile": "13800138000",​
	 "Email": ""​
 }​
}​

示例2：创建酒店订单​

{​
 "SourceTypeID": 1,​
 "PaymentMethodID": 1,​
 "SettlementTypeID": 11,​
 "Products": [​
	 {​
			 "ProductCategoryID": 2,​
			 "GDSCode": "Ctrip",​
			 "PublicAmount": 500.00,​
			 "Hotel": {​
				 "FQKey": "hotel_rate_code_xxxxx",​
				 "CityCode": "BJS",​
				 "CityName": "北京",​
				 "HotelName": "北京饭店",​
				 "CheckInDate": "2025-12-01",​
				 "CheckOutDate": "2025-12-02"​

}​
	 }​
 ],​
 "Passengers": [​
	 {​
			 "LastName": "李",​
			 "FirstName": "四",​
			 "PassengerTypeCode": "ADT",​
			 "Gender": "F",​
			 "CertTypeCode": "ID",​
			 "CertNr": "110101199002021234",​
			 "Mobile": "13900139000",​
			 "Birthday": "1990-02-02"​
	 }​
 ],​
 "ContactInfo": {​
	 "Name": "李四",​
	 "Mobile": "13900139000"​
 }​
}​

示例3：创建火车票订单​

{​
 "SourceTypeID": 1,​
 "PaymentMethodID": 1,​
 "SettlementTypeID": 11,​
 "Products": [​
	 {​
			 "ProductCategoryID": 3,​
			 "GDSCode": "12306",​
			 "Train": {​
				 "PlatformUserName": "",​				 "PlatformPassword": "password123",​
				 "Legs": [​
					 {​
					 "LegIndex": 1,​
					 "TrainNr": "G1",​
					 "FQKey": "train_fqkey_xxxxx"​

}​
				 ]​
			 }​
	 }​
 ],​
 "Passengers": [​
	 {​
			 "LastName": "王",​
			 "FirstName": "五",​
			 "PassengerTypeCode": "ADT",​
			 "Gender": "M",​
			 "CertTypeCode": "ID",​
			 "CertNr": "110101199003031234",​
			 "Mobile": "13700137000"​
	 }​
 ],​
 "ContactInfo": {​
	 "Name": "王五",​
	 "Mobile": "13700137000"​
 }​
}​

示例4：创建保险订单​

{​
 "SourceTypeID": 1,​
 "PaymentMethodID": 1,​
 "SettlementTypeID": 11,​
 "Products": [​
	 {​
			 "ProductCategoryID": 4,​
			 "GDSCode": "InsuranceProvider",​
			 "Insurance": {
				 "EffectiveStart": "2025-12-01T00:00:00",​
				 "EffectiveEnd": "2025-12-31T23:59:59",​
				 "ProductCode": "PROD001",​
				 "ProductName": "旅游意外险",​
				 "PlanCode": "PLAN001",​
				 "DestnName": "大连"​

}​
	 }​
 ],​
 "Passengers": [​
	 {​
			 "LastName": "赵",​
			 "FirstName": "六",​
			 "PassengerTypeCode": "ADT",​
			 "Gender": "F",​
			 "CertTypeCode": "ID",​
			 "CertNr": "110101199004041234",​
			 "Mobile": "13600136000",​
			 "InsFQKey": "insurance_fqkey_xxxxx"​
	 }​
 ],​
 "ContactInfo": {​
	 "Name": "赵六",​
	 "Mobile": "13600136000"​
 }​
}​

响应示例

成功响应

{​
 "Code": 0,​
 "Msg": "创建订单成功",​
 "TradeNo": "T202511180001",​
 "Orders": [​
	 {​
			 "OrderNo": "SO20251118001",​
			 "ProductCategoryID": 8,​
			 "PNR": "ABC123",​
			 "OrderStatusID": 23,​
			 "OrderStatusName": "座位确认",​
			 "Passengers": [​
				 {​

"PassengerTypeCode": "ADT",​
					 "PassengerName": "张三",​
					 "CertTypeCode": "ID",​
					 "CertNr": "110101199001011234"​
				 }​
			 ]​
	 }​
 ]​
}​

失败响应

{​
 "Code": 1001,​
 "Msg": "订座失败：余票不足",​
 "TradeNo": null,​
 "Orders": []​
}​

注意事项

必填参数验证：

SourceTypeID、PaymentMethodID、SettlementTypeID、Products、Passengers、ContactInfo 为必填参数​

不同产品类型有不同的必填字段要求

产品类型对应关系：

ProductCategoryID=8/9 时，必填 Air 对象​

ProductCategoryID=2 时，必填 Hotel 对象​

ProductCategoryID=3 时，必填 Train 对象​

ProductCategoryID=4 时，必填 Insurance 对象​

ProductCategoryID=5 时，必填 Visa 对象​

证件信息要求：

使用身份证时，Birthday 可从证件号自动解析​

使用护照等非身份证时，必须提供 Birthday 和 CertValid​

FQKey 获取：​
	机票的 FQKey 需要先调用机票验价接口获取​
	酒店的 FQKey 对应酒店的 RateCode​
	火车票的 FQKey 需要先调用火车票查询接口获取​
差旅政策：
	如果违背差旅政策，需要填写 ContrReason 和 ContrContent​	支持成本中心分摊，可按金额或百分比分摊
响应处理：
	Code=0 表示成功，其他值表示失败​
	机票订单需检查 PNR 是否为空，为空表示订座失败​
	火车票订单需检查 PONr 是否为空，为空表示下单失败​
接口总结

4. BizApi.OpenAPI.SubmitOrder​
提交订单
请求参数

响应结果
无

5. BizApi.OpenAPI.Shopping.VerifyCabin​
验舱并补位接口
请求参数
响应结果

6. BizApi.OpenAPI.GetOrderList​
请求参数
响应结果

OrderList​

ContactInfo​

OrderPassengerList​

OrderExpenseList​

OrderSegmentList​

7. BizApi.AirTickets.Shopping.PNRCancelByPSONr​
请求参数

响应结果

8. BizApi.OpenAPI.Shopping.AirReshopServing 改期航班查询​
请求参数

响应结果

JourneyBiz​

BriefRuleResult​

JourneySegmentResult​

JourneyTicketResult​

TicketAgencyResult​

TicketPricingResult​

TicketFareResult​

TicketFareFlightResult​

JourneyBrandResult​

9. BizApi.AirTickets.Shopping.AirRefundPriceServing 查询退票费​
请求参数

响应结果

10. BizApi.AirTickets.Shopping.GetFareRuleDetailServing  获取退改条款​
请求参数

响应结果

11. BizApi.OpenAPI.Dest.GetAirportList 获取全球机场信息​
说明

根据国家编码获取机场列表

请求参数

响应结果

AirportList​

