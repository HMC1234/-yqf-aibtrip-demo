# ä¸­èˆªæœæœºç¥¨æŸ¥è¯¢APIæµ‹è¯•æŒ‡å—

## ğŸš€ å¿«é€Ÿæµ‹è¯•æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨æµ‹è¯•é¡µé¢ï¼ˆæ¨èï¼‰

1. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm start
   ```

2. **è®¿é—®æµ‹è¯•é¡µé¢**
   - æµè§ˆå™¨æ‰“å¼€ï¼š`http://localhost:3000/test/yqf-api`
   - æˆ–ç›´æ¥è®¿é—®ï¼š`http://localhost:3000/test/yqf-api`

3. **é…ç½®APIä¿¡æ¯**
   - åœ¨"é…ç½®"æ ‡ç­¾é¡µå¡«å†™ï¼š
     - API Base URLï¼šä½ çš„APIåœ°å€
     - App Keyï¼šä½ çš„åº”ç”¨å¯†é’¥
     - App Secretï¼šä½ çš„åº”ç”¨å¯†é’¥ï¼ˆç”¨äºåŠ å¯†ï¼‰
     - API Versionï¼šv1ï¼ˆé»˜è®¤ï¼‰
   - ç‚¹å‡»"ä¿å­˜é…ç½®"

4. **æµ‹è¯•åŠ å¯†åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰**
   - åœ¨"åŠ å¯†æµ‹è¯•"éƒ¨åˆ†è¾“å…¥æµ‹è¯•æ–‡æœ¬
   - ç‚¹å‡»"æµ‹è¯•åŠ å¯†"
   - éªŒè¯åŠ å¯†ç»“æœ

5. **æµ‹è¯•èˆªç­æŸ¥è¯¢**
   - åˆ‡æ¢åˆ°"èˆªç­æŸ¥è¯¢"æ ‡ç­¾é¡µ
   - å¡«å†™æŸ¥è¯¢å‚æ•°ï¼ˆæˆ–ä½¿ç”¨é»˜è®¤å€¼ï¼‰ï¼š
     - å‡ºå‘åœ°ï¼šåŒ—äº¬
     - ç›®çš„åœ°ï¼šä¸Šæµ·
     - å‡ºå‘æ—¥æœŸï¼šé€‰æ‹©æœªæ¥æ—¥æœŸ
     - å…¶ä»–å‚æ•°ä½¿ç”¨é»˜è®¤å€¼
   - ç‚¹å‡»"æŸ¥è¯¢èˆªç­"æŒ‰é’®
   - æŸ¥çœ‹å“åº”æ•°æ®

### æ–¹æ³•2ï¼šé€šè¿‡ä»£ç ç›´æ¥æµ‹è¯•

å¦‚æœéœ€è¦é€šè¿‡ä»£ç ç›´æ¥æµ‹è¯•ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿è¡Œï¼š

```javascript
// 1. é¦–å…ˆè®¾ç½®æµ‹è¯•é…ç½®
window.__YQF_TEST_CONFIG__ = {
  baseUrl: 'ä½ çš„APIåœ°å€',
  appKey: 'ä½ çš„AppKey',
  appSecret: 'ä½ çš„AppSecret',
  version: 'v1'
};

// 2. å¯¼å…¥APIï¼ˆéœ€è¦åœ¨Reactç»„ä»¶ä¸­ï¼‰
import { FlightAPI } from './lib/yqf-air';
import { cityToAirportCode } from './lib/yqf-air/adapter';

// 3. è°ƒç”¨æŸ¥è¯¢æ¥å£
const params = {
  Passengers: [{ PassengerType: 'ADT' }],
  Routings: [{
    Departure: cityToAirportCode('åŒ—äº¬'),  // 'PEK'
    Arrival: cityToAirportCode('ä¸Šæµ·'),    // 'SHA'
    DepartureDate: '2024-12-25',
    DepartureType: 1,
    ArrivalType: 1,
  }],
  OnlyDirectFlight: false,
  BerthType: 'Y',
  Type: 'D',
  ChildQty: 0,
};

try {
  const response = await FlightAPI.searchFlights(params);
  console.log('æŸ¥è¯¢æˆåŠŸ:', response);
} catch (error) {
  console.error('æŸ¥è¯¢å¤±è´¥:', error);
}
```

## ğŸ“‹ æµ‹è¯•å‚æ•°è¯´æ˜

### å¿…å¡«å‚æ•°

- **Passengers**: ä¹˜å®¢ä¿¡æ¯æ•°ç»„
  - `PassengerType`: 'ADT'ï¼ˆæˆäººï¼‰/ 'CHD'ï¼ˆå„¿ç«¥ï¼‰/ 'INF'ï¼ˆå©´å„¿ï¼‰

- **Routings**: èˆªæ®µä¿¡æ¯æ•°ç»„
  - `Departure`: å‡ºå‘æœºåœºä»£ç ï¼ˆå¦‚ï¼šPEKã€CANã€SHAï¼‰
  - `Arrival`: åˆ°è¾¾æœºåœºä»£ç 
  - `DepartureDate`: å‡ºå‘æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
  - `DepartureType`: å‡ºå‘ç±»å‹ï¼ˆé»˜è®¤1ï¼‰
  - `ArrivalType`: åˆ°è¾¾ç±»å‹ï¼ˆé»˜è®¤1ï¼‰

### å¯é€‰å‚æ•°

- **OnlyDirectFlight**: æ˜¯å¦åªæŸ¥è¯¢ç›´é£ï¼ˆé»˜è®¤falseï¼‰
- **BerthType**: èˆ±ä½ç±»å‹ï¼ˆ'Y'ç»æµèˆ±/'C'å•†åŠ¡èˆ±/'F'å¤´ç­‰èˆ±ï¼‰
- **Type**: èˆªç­ç±»å‹ï¼ˆ'D'å›½å†…/'A'å›½é™…ï¼‰
- **ChildQty**: å„¿ç«¥æ•°é‡ï¼ˆé»˜è®¤0ï¼‰
- **IsQueryRule**: æ˜¯å¦æŸ¥è¯¢é€€æ”¹è§„åˆ™ï¼ˆé»˜è®¤falseï¼‰
- **IsQueryAirline**: æ˜¯å¦æŸ¥è¯¢èˆªç©ºå…¬å¸ï¼ˆé»˜è®¤falseï¼‰
- **CodeShare**: æ˜¯å¦æŸ¥è¯¢ä»£ç å…±äº«ï¼ˆé»˜è®¤falseï¼‰
- **IsQueryAirport**: æ˜¯å¦æŸ¥è¯¢æœºåœºï¼ˆé»˜è®¤falseï¼‰

## ğŸ“Š å“åº”æ•°æ®ç»“æ„

### æˆåŠŸå“åº”

```json
{
  "Code": 0,
  "Msg": "è°ƒç”¨æˆåŠŸ",
  "Data": {
    "JourneyBiz": [...],           // è¡Œç¨‹ä¸šåŠ¡ä¿¡æ¯
    "BriefRuleResult": [...],      // ç®€è¦è§„åˆ™ç»“æœ
    "JourneySegmentResult": [...], // èˆªæ®µç»“æœ
    "JourneyTicketResult": [...],  // ç¥¨åŠ¡ç»“æœ
    "TicketAgencyResult": [...],   // ä»£ç†ç»“æœ
    "TicketPricingResult": [...],  // å®šä»·ç»“æœ
    "TicketFareResult": [...],     // ç¥¨ä»·ç»“æœ
    "TicketFareFlightResult": [...], // èˆªç­ç¥¨ä»·ç»“æœ
    "JourneyBrandResult": [...]    // å“ç‰Œç»“æœ
  }
}
```

### å¤±è´¥å“åº”

```json
{
  "Code": 1001,
  "Msg": "é”™è¯¯ä¿¡æ¯",
  "Data": null
}
```

## ğŸ” æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] APIé…ç½®ä¿¡æ¯å·²å¡«å†™
- [ ] é…ç½®å·²ä¿å­˜
- [ ] æŸ¥è¯¢å‚æ•°å·²å¡«å†™
- [ ] å‡ºå‘åœ°å’Œç›®çš„åœ°å·²é€‰æ‹©
- [ ] å‡ºå‘æ—¥æœŸå·²é€‰æ‹©ï¼ˆæœªæ¥æ—¥æœŸï¼‰
- [ ] ç‚¹å‡»"æŸ¥è¯¢èˆªç­"æŒ‰é’®
- [ ] æŸ¥çœ‹å“åº”æ•°æ®
- [ ] éªŒè¯å“åº”Codeæ˜¯å¦ä¸º0
- [ ] éªŒè¯å“åº”Dataæ˜¯å¦åŒ…å«èˆªç­ä¿¡æ¯

## âš ï¸ å¸¸è§é—®é¢˜

### 1. æç¤º"é…ç½®ä¸å®Œæ•´"
**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥æ˜¯å¦åœ¨"é…ç½®"æ ‡ç­¾é¡µå¡«å†™äº†æ‰€æœ‰å¿…å¡«ä¿¡æ¯
- ç¡®ä¿ç‚¹å‡»äº†"ä¿å­˜é…ç½®"æŒ‰é’®

### 2. æç¤º"APIè°ƒç”¨å¤±è´¥"
**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥API Base URLæ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æ£€æŸ¥App Keyå’ŒApp Secretæ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

### 3. æŸ¥è¯¢è¿”å›ç©ºç»“æœ
**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥å‡ºå‘åœ°å’Œç›®çš„åœ°æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æ—¥æœŸæ˜¯å¦ä¸ºæœªæ¥æ—¥æœŸ
- æ£€æŸ¥èˆªç­ç±»å‹ï¼ˆå›½å†…/å›½é™…ï¼‰æ˜¯å¦æ­£ç¡®
- å°è¯•è°ƒæ•´æŸ¥è¯¢å‚æ•°ï¼ˆå¦‚ï¼šå–æ¶ˆ"ä»…ç›´é£"é™åˆ¶ï¼‰

### 4. åŠ å¯†æµ‹è¯•å¤±è´¥
**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥App Secreté•¿åº¦æ˜¯å¦ä¸º16æˆ–32å­—èŠ‚
- æ£€æŸ¥æµ‹è¯•æ–‡æœ¬æ˜¯å¦ä¸ºæœ‰æ•ˆçš„JSONæ ¼å¼

## ğŸ“ æµ‹è¯•ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæŸ¥è¯¢åŒ—äº¬åˆ°ä¸Šæµ·çš„å›½å†…èˆªç­

```json
{
  "Passengers": [{ "PassengerType": "ADT" }],
  "Routings": [{
    "Departure": "PEK",
    "Arrival": "SHA",
    "DepartureDate": "2024-12-25",
    "DepartureType": 1,
    "ArrivalType": 1
  }],
  "OnlyDirectFlight": false,
  "BerthType": "Y",
  "Type": "D",
  "ChildQty": 0
}
```

### ç¤ºä¾‹2ï¼šæŸ¥è¯¢å¾€è¿”èˆªç­

```json
{
  "Passengers": [{ "PassengerType": "ADT" }],
  "Routings": [
    {
      "Departure": "PEK",
      "Arrival": "SHA",
      "DepartureDate": "2024-12-25",
      "DepartureType": 1,
      "ArrivalType": 1
    },
    {
      "Departure": "SHA",
      "Arrival": "PEK",
      "DepartureDate": "2024-12-28",
      "DepartureType": 1,
      "ArrivalType": 1
    }
  ],
  "OnlyDirectFlight": false,
  "BerthType": "Y",
  "Type": "D"
}
```

## ğŸ¯ ä¸‹ä¸€æ­¥

æŸ¥è¯¢æˆåŠŸåï¼Œå¯ä»¥ï¼š
1. ä»å“åº”ä¸­æå–FQKey
2. ä½¿ç”¨FQKeyè¿›è¡ŒéªŒä»·æµ‹è¯•
3. ä½¿ç”¨éªŒä»·ç»“æœåˆ›å»ºè®¢å•

---

**æç¤º**ï¼šå»ºè®®å…ˆä½¿ç”¨æµ‹è¯•é¡µé¢è¿›è¡Œæµ‹è¯•ï¼Œè¿™æ ·å¯ä»¥ç›´è§‚åœ°çœ‹åˆ°æ‰€æœ‰å‚æ•°å’Œå“åº”æ•°æ®ã€‚

