# æœºç¥¨æŸ¥è¯¢æ¥å£è°ƒç”¨è¯´æ˜

## âœ… ç¡®è®¤ï¼šæœºç¥¨æŸ¥è¯¢ç¡®å®åœ¨è°ƒç”¨ `https://bizapi.yiqifei.cn/servings`

## ğŸ“ å®Œæ•´è°ƒç”¨æµç¨‹

### 1. ä»£ç è°ƒç”¨

**æ–‡ä»¶**: `src/lib/yqf-air/flight-api.ts`

```typescript
static async searchFlights(params: FlightSearchParams) {
  return yqfClient.call<FlightSearchResult>(
    'BizApi.OpenAPI.Shopping.EasyShopping_V2',  // æ¥å£æ–¹æ³•å
    params
  )
}
```

### 2. æ„å»ºè¯·æ±‚URL

**æ–‡ä»¶**: `src/lib/yqf-air/client.ts`

```typescript
// åŸºç¡€åœ°å€
const baseUrl = 'https://bizapi.yiqifei.cn/servings'

// ç³»ç»Ÿçº§å‚æ•°
const systemParams = {
  app_key: 'ä½ çš„AppKey',
  method: 'BizApi.OpenAPI.Shopping.EasyShopping_V2',
}

// å®Œæ•´URL
const url = `${baseUrl}?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2`
```

### 3. å®é™…è¯·æ±‚URL

**å¼€å‘ç¯å¢ƒï¼ˆé€šè¿‡ä»£ç†ï¼‰**:
```
å®¢æˆ·ç«¯è¯·æ±‚: http://localhost:3000/api/yqf?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
ä»£ç†è½¬å‘åˆ°: https://bizapi.yiqifei.cn/servings?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
```

**ç”Ÿäº§ç¯å¢ƒï¼ˆç›´æ¥è°ƒç”¨ï¼‰**:
```
ç›´æ¥è¯·æ±‚: https://bizapi.yiqifei.cn/servings?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
```

## ğŸ” éªŒè¯æ–¹æ³•

### æ–¹æ³•1: æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°

æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåœ¨Consoleä¸­åº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ” [APIè°ƒç”¨] é…ç½®ä¿¡æ¯: {
  baseUrl: "/api/yqf"  // å¼€å‘ç¯å¢ƒä½¿ç”¨ä»£ç†
}

ğŸ” [APIè°ƒç”¨] æœ€ç»ˆURL: /api/yqf?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
```

### æ–¹æ³•2: æŸ¥çœ‹Networkæ ‡ç­¾

1. æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ°Networkæ ‡ç­¾
3. ç‚¹å‡»"æŸ¥è¯¢èˆªç­"æŒ‰é’®
4. æ‰¾åˆ°è¯·æ±‚ï¼ŒæŸ¥çœ‹ï¼š
   - **è¯·æ±‚URL**: `http://localhost:3000/api/yqf?...`
   - **å®é™…è½¬å‘åˆ°**: `https://bizapi.yiqifei.cn/servings?...`

### æ–¹æ³•3: æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—

åœ¨è¿è¡Œ `npm start` çš„ç»ˆç«¯ä¸­ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ”µ [ä»£ç†] è¯·æ±‚: POST /api/yqf?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
ğŸ”µ [ä»£ç†] ç›®æ ‡è·¯å¾„: /servings?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
ğŸ”µ [ä»£ç†] ç›®æ ‡ä¸»æœº: bizapi.yiqifei.cn
ğŸŸ¢ [ä»£ç†] å“åº”: 200 /api/yqf?app_key=xxx&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
```

## ğŸ“‹ å®Œæ•´è¯·æ±‚ä¿¡æ¯

### HTTPè¯·æ±‚è¯¦æƒ…

**è¯·æ±‚æ–¹æ³•**: POST

**è¯·æ±‚URL**: 
```
https://bizapi.yiqifei.cn/servings?app_key=ä½ çš„AppKey&method=BizApi.OpenAPI.Shopping.EasyShopping_V2
```

**è¯·æ±‚å¤´**:
```
Content-Type: text/plain
Accept-Encoding: gzip, deflate
```

**è¯·æ±‚ä½“**:
```
åŠ å¯†åçš„ä¸šåŠ¡å‚æ•°ï¼ˆBase64ç¼–ç çš„AESåŠ å¯†æ•°æ®ï¼‰
```

### ä¸šåŠ¡å‚æ•°ç¤ºä¾‹

```json
{
  "Passengers": [
    { "PassengerType": "ADT" }
  ],
  "Routings": [
    {
      "Departure": "PEK",
      "Arrival": "SHA",
      "DepartureDate": "2025-11-25",
      "DepartureType": 1,
      "ArrivalType": 1
    }
  ],
  "OnlyDirectFlight": false,
  "BerthType": "Y",
  "Type": "D"
}
```

## âœ… æ€»ç»“

- âœ… **åŸºç¡€åœ°å€**: `https://bizapi.yiqifei.cn/servings`
- âœ… **æ¥å£æ–¹æ³•**: `BizApi.OpenAPI.Shopping.EasyShopping_V2`
- âœ… **è°ƒç”¨æ–¹å¼**: POSTè¯·æ±‚ï¼Œä¸šåŠ¡å‚æ•°åŠ å¯†åæ”¾åœ¨Bodyä¸­
- âœ… **å¼€å‘ç¯å¢ƒ**: é€šè¿‡ä»£ç†è½¬å‘ï¼ˆè§£å†³CORSé—®é¢˜ï¼‰
- âœ… **ç”Ÿäº§ç¯å¢ƒ**: ç›´æ¥è°ƒç”¨

---

**ç¡®è®¤**: æœºç¥¨æŸ¥è¯¢ç¡®å®åœ¨è°ƒç”¨ `https://bizapi.yiqifei.cn/servings` æ¥å£ âœ…


